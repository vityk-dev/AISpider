name: CI

# This triggers the workflow on push or pull request to the main branch
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  # Job 1: Check for Python syntax errors
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Python 3.10
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"
          
      - name: Install Linting Tool
        run: pip install flake8
        
      - name: Run Linting
        # This checks for syntax errors (E9, F63, etc.) across all folders
        run: |
          # Stop the build if there are Python syntax errors or undefined names
          flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics

  # Job 2: Ensure the Docker image actually builds
  # This is crucial because your Dockerfile copies requirements from multiple folders
  build-container:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Build Docker Image
        # This runs the same build command as your "robot" service
        run: docker build . --file Dockerfile